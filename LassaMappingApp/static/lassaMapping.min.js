if(window.matchMedia("(max-width: 767px)").matches)var mapOptions={center:[9.531665,4.460415],zoom:3,tap:!1};else mapOptions={center:[10.531665,0],zoom:5,tap:!1};var map=new L.map("map",mapOptions),layer=new L.TileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");map.addLayer(layer);var markers=L.markerClusterGroup(),start_year_select=$("#StartYear"),end_year_select=$("#EndYear");function getUpdatedEndYear(e,r){var i={start_year:e,host:r};$.ajax({async:!1,url:"/_get_end_year",data:i,dataType:"json",success:function(e){for(var r in end_year_select.empty(),e)end_year_select.append($("<option>",{value:e[r].end_year,text:e[r].end_year},"</option>"))}})}function GetFilteredPoints(e,r,i){var a={start_year:e,end_year:r,host:i};return $.ajax({async:!1,url:"/_filter_points",data:a,dataType:"json",success:function(e){result=e}}),result}function MapPoints(e,r,i){i=i;for(var a in markers.clearLayers(),i.removeLayer(markers),e){if(coordPair=e[a],"human"==r){var o=L.icon({iconUrl:"/static/images/baseline_person_black_18dp.png",iconSize:[35,35]}),t="<b>Serology, proportion positive:</b> "+coordPair.PropAb,n="<b>Serology, number tested:</b> "+coordPair.NumTestAb,b="<b>Citation:</b> "+coordPair.Citation;if("unspecified"==coordPair.DOI)s="<b>DOI:</b> unspecified";else var s="<b>DOI:</b> <a href='https://doi.org/"+coordPair.DOI+"' target='_blank'>link</a>";title=t+"<br>"+n+"<br> <br>"+b+"<br> <br>"+s}if("rodent"==r){o=L.icon({iconUrl:"/static/images/baseline_pest_control_rodent_black_18dp.png",iconSize:[35,35]}),t="<b>Serology, proportion positive:</b> "+coordPair.PropAb,n="<b>Serology, number tested:</b> "+coordPair.NumTestAb;var d="<b>Virus detection, proportion positive:</b> "+coordPair.PropVirus,c="<b>Virus detection, number tested:</b> "+coordPair.NumTestVirus;b="<b> Citation:</b> "+coordPair.Citation;if("unspecified"==coordPair.DOI)s="<b>DOI:</b> unspecified";else s="<b>DOI:</b> <a href='https://doi.org/"+coordPair.DOI+"' target='_blank'>link</a>";title=t+"<br>"+n+"<br> <br>"+d+"<br>"+c+"<br> <br>"+b+"<br> <br>"+s}if("sequence rodent"==r){o=L.icon({iconUrl:"/static/images/baseline_virus_black_18dp.png",iconSize:[35,35]});var p="<b>GenBank description:</b> "+coordPair.gbDefinition,l="<b>Reference:</b> "+coordPair.Reference;if("unspecified"==coordPair.gbPubMedID)u="<b>PubMed:</b> unspecified";else var u="<b>PubMed:</b> <a href='https://pubmed.ncbi.nlm.nih.gov/"+coordPair.gbPubMedID+"' target='_blank'>link</a>";title=p+"<br> <br>"+l+"<br> <br>"+u}if("sequence human"==r){o=L.icon({iconUrl:"/static/images/baseline_virus_black_18dp.png",iconSize:[35,35]}),p="<b>GenBank description:</b> "+coordPair.gbDefinition,l="<b>Reference:</b> "+coordPair.Reference;if("unspecified"==coordPair.gbPubMedID)u="<b>PubMed:</b> unspecified";else u="<b>PubMed:</b> <a href='https://pubmed.ncbi.nlm.nih.gov/"+coordPair.gbPubMedID+"' target='_blank'>link</a>";title=p+"<br> <br>"+l+"<br> <br>"+u}var m=L.marker(new L.LatLng(coordPair.Latitude,coordPair.Longitude,{title:title}));m.bindPopup(title),m.setIcon(o),markers.addLayer(m)}i.addLayer(markers)}
